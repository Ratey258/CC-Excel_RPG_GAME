<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Excel - Â∑•‰ΩúÁ∞ø1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background-color: #f3f2f1;
            overflow: hidden;
        }

        /* ExcelÊ†áÈ¢òÊ†è */
        .excel-titlebar {
            background: #2b579a;
            color: white;
            padding: 8px 15px;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .excel-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .excel-logo {
            width: 20px;
            height: 20px;
            background: #107c41;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        .window-controls {
            display: flex;
            gap: 1px;
        }

        .control-btn {
            width: 45px;
            height: 29px;
            border: none;
            background: transparent;
            color: white;
            cursor: pointer;
            font-size: 12px;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        /* ExcelËèúÂçïÊ†è */
        .excel-menubar {
            background: #ffffff;
            border-bottom: 1px solid #d1d1d1;
            display: flex;
            align-items: center;
            height: 48px;
        }

        .menu-tabs {
            display: flex;
            margin-left: 15px;
        }

        .menu-tab {
            padding: 12px 20px;
            cursor: pointer;
            color: #323130;
            font-size: 14px;
            border-bottom: 3px solid transparent;
        }

        .menu-tab.active {
            border-bottom-color: #0078d4;
            color: #0078d4;
        }

        .menu-tab:hover {
            background: #f3f2f1;
        }

        /* ExcelÂ∑•ÂÖ∑Ê†è */
        .excel-toolbar {
            background: #ffffff;
            border-bottom: 1px solid #d1d1d1;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            height: 92px;
            flex-wrap: wrap;
        }

        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 5px;
            padding-right: 15px;
            border-right: 1px solid #d1d1d1;
        }

        .toolbar-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .toolbar-btn:hover {
            background: #f3f2f1;
        }

        /* ÂÖ¨ÂºèÊ†è */
        .formula-bar {
            background: #ffffff;
            border-bottom: 1px solid #d1d1d1;
            height: 25px;
            display: flex;
            align-items: center;
            padding: 0 15px;
        }

        .name-box {
            width: 80px;
            height: 21px;
            border: 1px solid #a6a6a6;
            padding: 0 5px;
            font-size: 11px;
        }

        .formula-input {
            flex: 1;
            height: 21px;
            border: 1px solid #a6a6a6;
            margin-left: 5px;
            padding: 0 5px;
            font-size: 11px;
        }

        /* ExcelÂ∑•‰ΩúË°®Âå∫Âüü */
        .excel-worksheet {
            background: #ffffff;
            height: calc(100vh - 225px);
            overflow: auto;
            position: relative;
        }

        /* Ë°åÂàóÊ†áÈ¢ò */
        .column-headers {
            position: sticky;
            top: 0;
            background: #f8f8f8;
            border-bottom: 1px solid #d4d4d4;
            display: flex;
            height: 20px;
            z-index: 10;
        }

        .corner-cell {
            width: 42px;
            min-width: 42px;
            background: #f8f8f8;
            border-right: 1px solid #d4d4d4;
            border-bottom: 1px solid #d4d4d4;
        }

        .column-header {
            width: 80px;
            min-width: 80px;
            text-align: center;
            font-size: 11px;
            color: #323130;
            line-height: 20px;
            border-right: 1px solid #d4d4d4;
            background: #f8f8f8;
            cursor: pointer;
        }

        /* Â∑•‰ΩúË°®ÂÜÖÂÆπ */
        .worksheet-content {
            display: flex;
            flex-direction: column;
        }

        .worksheet-row {
            display: flex;
            height: 20px;
        }

        .row-header {
            width: 42px;
            min-width: 42px;
            text-align: center;
            font-size: 11px;
            color: #323130;
            background: #f8f8f8;
            border-right: 1px solid #d4d4d4;
            border-bottom: 1px solid #e8e8e8;
            line-height: 20px;
            cursor: pointer;
        }

        .excel-cell {
            width: 80px;
            min-width: 80px;
            height: 20px;
            border-right: 1px solid #e8e8e8;
            border-bottom: 1px solid #e8e8e8;
            padding: 2px 6px;
            font-size: 11px;
            position: relative;
            cursor: cell;
        }

        .excel-cell:hover {
            background: #f3f2f1;
        }

        .excel-cell.selected {
            background: #0078d4;
            color: white;
        }

        .excel-cell.game-cell {
            background: #fff2cc;
            color: #9c5700;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }

        .excel-cell.monster-cell {
            background: #ffcccc;
            color: #c5504b;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }

        .excel-cell.treasure-cell {
            background: #e1dfdd;
            color: #7719aa;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }

        /* Áä∂ÊÄÅÊ†è */
        .excel-statusbar {
            background: #0078d4;
            color: white;
            height: 22px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            font-size: 11px;
            justify-content: space-between;
        }

        .status-left {
            display: flex;
            gap: 20px;
        }

        .status-right {
            display: flex;
            gap: 10px;
        }

        /* Ê∏∏ÊàèÈù¢Êùø */
        .game-panel {
            position: fixed;
            top: 50px;
            right: 20px;
            width: 200px;
            background: white;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            padding: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            font-size: 12px;
            z-index: 1000;
            display: none;
        }

        .game-panel.show {
            display: block;
        }

        .panel-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #323130;
            border-bottom: 1px solid #e1dfdd;
            padding-bottom: 5px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e1dfdd;
            border-radius: 3px;
            overflow: hidden;
            margin: 5px 0;
        }

        .progress-fill {
            height: 100%;
            background: #0078d4;
            transition: width 0.3s;
        }

        /* ÈöêËóèÁöÑÊ∏∏ÊàèÊ∂àÊÅØ */
        .game-message {
            position: fixed;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            background: #323130;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .game-message.show {
            opacity: 1;
        }

    </style>
</head>
<body>
    <!-- ExcelÊ†áÈ¢òÊ†è -->
    <div class="excel-titlebar">
        <div class="excel-title">
            <div class="excel-logo">X</div>
            <span>Â∑•‰ΩúÁ∞ø1 - Excel</span>
        </div>
        <div class="window-controls">
            <button class="control-btn">‚àí</button>
            <button class="control-btn">‚ñ°</button>
            <button class="control-btn">√ó</button>
        </div>
    </div>

    <!-- ExcelËèúÂçïÊ†è -->
    <div class="excel-menubar">
        <div class="menu-tabs">
            <div class="menu-tab">Êñá‰ª∂</div>
            <div class="menu-tab active">ÂºÄÂßã</div>
            <div class="menu-tab">ÊèíÂÖ•</div>
            <div class="menu-tab">È°µÈù¢Â∏ÉÂ±Ä</div>
            <div class="menu-tab">ÂÖ¨Âºè</div>
            <div class="menu-tab">Êï∞ÊçÆ</div>
            <div class="menu-tab">ÂÆ°ÈòÖ</div>
            <div class="menu-tab">ËßÜÂõæ</div>
        </div>
    </div>

    <!-- ExcelÂ∑•ÂÖ∑Ê†è -->
    <div class="excel-toolbar">
        <div class="toolbar-group">
            <button class="toolbar-btn" title="Á≤òË¥¥">üìã</button>
        </div>
        <div class="toolbar-group">
            <button class="toolbar-btn" title="Ââ™Âàá">‚úÇ</button>
            <button class="toolbar-btn" title="Â§çÂà∂">üìÑ</button>
            <button class="toolbar-btn" title="Ê†ºÂºèÂà∑">üñå</button>
        </div>
        <div class="toolbar-group">
            <button class="toolbar-btn" title="Âä†Á≤ó">B</button>
            <button class="toolbar-btn" title="Êñú‰Ωì">I</button>
            <button class="toolbar-btn" title="‰∏ãÂàíÁ∫ø">U</button>
        </div>
        <div class="toolbar-group">
            <button class="toolbar-btn" title="ÂáΩÊï∞" onclick="toggleGamePanel()">fx</button>
            <button class="toolbar-btn" title="ÂõæË°®" onclick="showGameStats()">üìä</button>
        </div>
    </div>

    <!-- ÂÖ¨ÂºèÊ†è -->
    <div class="formula-bar">
        <input type="text" class="name-box" value="A1" readonly>
        <input type="text" class="formula-input" id="formulaInput" placeholder="ÁÇπÂáªÂçïÂÖÉÊ†ºÂºÄÂßãÊ∏∏Êàè..." readonly>
    </div>

    <!-- ExcelÂ∑•‰ΩúË°® -->
    <div class="excel-worksheet">
        <div class="column-headers">
            <div class="corner-cell"></div>
            <div class="column-header">A</div>
            <div class="column-header">B</div>
            <div class="column-header">C</div>
            <div class="column-header">D</div>
            <div class="column-header">E</div>
            <div class="column-header">F</div>
            <div class="column-header">G</div>
            <div class="column-header">H</div>
            <div class="column-header">I</div>
            <div class="column-header">J</div>
            <div class="column-header">K</div>
            <div class="column-header">L</div>
            <div class="column-header">M</div>
            <div class="column-header">N</div>
            <div class="column-header">O</div>
            <div class="column-header">P</div>
        </div>
        
        <div class="worksheet-content" id="worksheetContent">
            <!-- Â∑•‰ΩúË°®Ë°åÂ∞ÜÈÄöËøáJavaScriptÁîüÊàê -->
        </div>
    </div>

    <!-- ExcelÁä∂ÊÄÅÊ†è -->
    <div class="excel-statusbar">
        <div class="status-left">
            <span>Â∞±Áª™</span>
            <span id="gameStatus">ÁªèÈ™åÂÄº: 0 | Á≠âÁ∫ß: 1</span>
        </div>
        <div class="status-right">
            <span>100%</span>
            <span>Á¨¨ 1 È°µÔºåÂÖ± 1 È°µ</span>
        </div>
    </div>

    <!-- ÈöêËóèÁöÑÊ∏∏ÊàèÈù¢Êùø -->
    <div class="game-panel" id="gamePanel">
        <div class="panel-title">üìä Êï∞ÊçÆÈÄèËßÜË°®</div>
        <div class="stat-row">
            <span>Á≠âÁ∫ß:</span>
            <span id="playerLevel">1</span>
        </div>
        <div class="stat-row">
            <span>ÁªèÈ™å:</span>
            <span id="playerExp">0/100</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="expBar" style="width: 0%"></div>
        </div>
        <div class="stat-row">
            <span>ÈáëÂ∏Å:</span>
            <span id="playerGold">0</span>
        </div>
        <div class="stat-row">
            <span>ÊÄ™Áâ©ÂáªË¥•:</span>
            <span id="monstersKilled">0</span>
        </div>
        <div class="stat-row">
            <span>ÂÆùÁÆ±ÂºÄÂêØ:</span>
            <span id="treasuresFound">0</span>
        </div>
    </div>


    <!-- Ê∏∏ÊàèÊ∂àÊÅØ -->
    <div class="game-message" id="gameMessage"></div>

    <script>
        // Ê∏∏ÊàèÁä∂ÊÄÅ
        let gameState = {
            level: 1,
            exp: 0,
            expNeeded: 100,
            gold: 0,
            monstersKilled: 0,
            treasuresFound: 0,
            totalClicks: 0,
            errorCount: 0
        };

        // Ê∏∏ÊàèÊï∞ÊçÆ
        const gameData = {
            monsters: ['üëπ', 'üêâ', 'üëæ', 'ü¶ñ', 'üï∑Ô∏è', 'üê∫', 'ü¶á', 'üêç'],
            treasures: ['üíé', 'üëë', 'üí∞', 'üèÜ', 'üíç', 'üéÅ', '‚ö±Ô∏è', 'üìø'],
            heroes: ['üßô', '‚öîÔ∏è', 'üõ°Ô∏è', 'üèπ', '‚ö°', 'üî•', '‚ùÑÔ∏è', '‚ú®']
        };

        // ÂàõÂª∫Â∑•‰ΩúË°®
        function createWorksheet() {
            const worksheetContent = document.getElementById('worksheetContent');
            worksheetContent.innerHTML = '';

            for (let row = 1; row <= 50; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'worksheet-row';
                
                // Ë°åÊ†áÈ¢ò
                const rowHeader = document.createElement('div');
                rowHeader.className = 'row-header';
                rowHeader.textContent = row;
                rowDiv.appendChild(rowHeader);

                // ÂçïÂÖÉÊ†º
                for (let col = 0; col < 16; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'excel-cell';
                    cell.setAttribute('data-row', row);
                    cell.setAttribute('data-col', col);
                    
                    // ÈöèÊú∫Ê∑ªÂä†Ê∏∏ÊàèÂÖÉÁ¥†
                    if (Math.random() < 0.02) { // 2% Ê¶ÇÁéá
                        const type = Math.random();
                        if (type < 0.4) {
                            // ÊÄ™Áâ©
                            cell.className += ' monster-cell';
                            cell.textContent = gameData.monsters[Math.floor(Math.random() * gameData.monsters.length)];
                            cell.setAttribute('data-type', 'monster');
                        } else if (type < 0.7) {
                            // ÂÆùÁÆ±
                            cell.className += ' treasure-cell';
                            cell.textContent = gameData.treasures[Math.floor(Math.random() * gameData.treasures.length)];
                            cell.setAttribute('data-type', 'treasure');
                        } else {
                            // Ëã±ÈõÑ/ÊäÄËÉΩ
                            cell.className += ' game-cell';
                            cell.textContent = gameData.heroes[Math.floor(Math.random() * gameData.heroes.length)];
                            cell.setAttribute('data-type', 'hero');
                        }
                    } else {
                        // ÊôÆÈÄöÊï∞ÊçÆ
                        const dataTypes = [
                            Math.floor(Math.random() * 1000),
                            (Math.random() * 100).toFixed(2),
                            '',
                            ['A', 'B', 'C', 'D'][Math.floor(Math.random() * 4)],
                            Math.floor(Math.random() * 10000),
                            ''
                        ];
                        cell.textContent = dataTypes[Math.floor(Math.random() * dataTypes.length)];
                    }
                    
                    cell.addEventListener('click', handleCellClick);
                    rowDiv.appendChild(cell);
                }
                
                worksheetContent.appendChild(rowDiv);
            }
        }

        // Â§ÑÁêÜÂçïÂÖÉÊ†ºÁÇπÂáª
        function handleCellClick(event) {
            const cell = event.target;
            const type = cell.getAttribute('data-type');
            const row = cell.getAttribute('data-row');
            const col = String.fromCharCode(65 + parseInt(cell.getAttribute('data-col')));
            
            // Êõ¥Êñ∞ÂÖ¨ÂºèÊ†è
            document.getElementById('formulaInput').value = `=${col}${row}`;
            document.querySelector('.name-box').value = `${col}${row}`;

            gameState.totalClicks++;
            
            if (type === 'monster') {
                // ÂáªË¥•ÊÄ™Áâ©
                const exp = Math.floor(Math.random() * 25) + 10;
                const gold = Math.floor(Math.random() * 15) + 5;
                
                addExp(exp);
                gameState.gold += gold;
                gameState.monstersKilled++;
                
                cell.textContent = 'üíÄ';
                cell.className = 'excel-cell';
                cell.removeAttribute('data-type');
                
                showMessage(`ÂáªË¥•ÊÄ™Áâ©! +${exp} ÁªèÈ™å, +${gold} ÈáëÂ∏Å`);
                
            } else if (type === 'treasure') {
                // ÂºÄÂêØÂÆùÁÆ±
                const exp = Math.floor(Math.random() * 40) + 20;
                const gold = Math.floor(Math.random() * 30) + 15;
                
                addExp(exp);
                gameState.gold += gold;
                gameState.treasuresFound++;
                
                cell.textContent = 'üì¶';
                cell.className = 'excel-cell';
                cell.removeAttribute('data-type');
                
                showMessage(`ÂèëÁé∞ÂÆùÁÆ±! +${exp} ÁªèÈ™å, +${gold} ÈáëÂ∏Å`);
                
            } else if (type === 'hero') {
                // Ëé∑ÂæóÊäÄËÉΩ/buff
                const exp = Math.floor(Math.random() * 15) + 5;
                addExp(exp);
                
                cell.textContent = '‚≠ê';
                cell.className = 'excel-cell';
                cell.removeAttribute('data-type');
                
                showMessage(`Ëé∑ÂæóÊäÄËÉΩÂº∫Âåñ! +${exp} ÁªèÈ™å`);
                
            } else {
                // ÊôÆÈÄöÂçïÂÖÉÊ†º - Â∞èÈáèÁªèÈ™å
                if (Math.random() < 0.1) { // 10% Ê¶ÇÁéáËé∑ÂæóÁªèÈ™å
                    const exp = Math.floor(Math.random() * 3) + 1;
                    addExp(exp);
                    showMessage(`Êï∞ÊçÆÂàÜÊûêÂÆåÊàê +${exp} ÁªèÈ™å`);
                }
            }
            
            updateDisplay();
        }

        // Â¢ûÂä†ÁªèÈ™åÂÄº
        function addExp(amount) {
            gameState.exp += amount;
            
            // Ê£ÄÊü•ÂçáÁ∫ß
            while (gameState.exp >= gameState.expNeeded) {
                gameState.exp -= gameState.expNeeded;
                gameState.level++;
                gameState.expNeeded = Math.floor(gameState.expNeeded * 1.5);
                
                showMessage(`üéâ Á≠âÁ∫ßÊèêÂçá! Áé∞Âú®ÊòØ ${gameState.level} Á∫ß!`);
                
                // ÂçáÁ∫ßÊó∂Âà∑Êñ∞Âú∞Âõæ
                setTimeout(() => {
                    refreshGameElements();
                }, 1000);
            }
        }

        // Âà∑Êñ∞Ê∏∏ÊàèÂÖÉÁ¥†
        function refreshGameElements() {
            const cells = document.querySelectorAll('.excel-cell');
            let addedElements = 0;
            
            cells.forEach(cell => {
                if (!cell.getAttribute('data-type') && addedElements < 15) {
                    if (Math.random() < 0.05) { // 5% Ê¶ÇÁéáÊ∑ªÂä†Êñ∞ÂÖÉÁ¥†
                        const type = Math.random();
                        if (type < 0.4) {
                            cell.className = 'excel-cell monster-cell';
                            cell.textContent = gameData.monsters[Math.floor(Math.random() * gameData.monsters.length)];
                            cell.setAttribute('data-type', 'monster');
                        } else if (type < 0.7) {
                            cell.className = 'excel-cell treasure-cell';
                            cell.textContent = gameData.treasures[Math.floor(Math.random() * gameData.treasures.length)];
                            cell.setAttribute('data-type', 'treasure');
                        } else {
                            cell.className = 'excel-cell game-cell';
                            cell.textContent = gameData.heroes[Math.floor(Math.random() * gameData.heroes.length)];
                            cell.setAttribute('data-type', 'hero');
                        }
                        addedElements++;
                    }
                }
            });
        }

        // ÊòæÁ§∫Ê∂àÊÅØ
        function showMessage(message) {
            const messageEl = document.getElementById('gameMessage');
            messageEl.textContent = message;
            messageEl.classList.add('show');
            
            setTimeout(() => {
                messageEl.classList.remove('show');
            }, 2000);
        }

        // Êõ¥Êñ∞ÊòæÁ§∫
        function updateDisplay() {
            // Êõ¥Êñ∞Áä∂ÊÄÅÊ†è
            document.getElementById('gameStatus').textContent = 
                `ÁªèÈ™åÂÄº: ${gameState.exp}/${gameState.expNeeded} | Á≠âÁ∫ß: ${gameState.level}`;
            
            // Êõ¥Êñ∞Ê∏∏ÊàèÈù¢Êùø
            document.getElementById('playerLevel').textContent = gameState.level;
            document.getElementById('playerExp').textContent = `${gameState.exp}/${gameState.expNeeded}`;
            document.getElementById('playerGold').textContent = gameState.gold;
            document.getElementById('monstersKilled').textContent = gameState.monstersKilled;
            document.getElementById('treasuresFound').textContent = gameState.treasuresFound;
            
            const expPercent = (gameState.exp / gameState.expNeeded) * 100;
            document.getElementById('expBar').style.width = `${expPercent}%`;
            
        }

        // ÂàáÊç¢Ê∏∏ÊàèÈù¢Êùø
        function toggleGamePanel() {
            const panel = document.getElementById('gamePanel');
            panel.classList.toggle('show');
        }

        // ÊòæÁ§∫Ê∏∏ÊàèÁªüËÆ°
        function showGameStats() {
            const panel = document.getElementById('gamePanel');
            panel.classList.add('show');
            showMessage('Êï∞ÊçÆÈÄèËßÜË°®Â∑≤Êõ¥Êñ∞');
        }

        // Ëá™Âä®Âà∑Êñ∞Ê∏∏ÊàèÂÖÉÁ¥†
        setInterval(() => {
            if (Math.random() < 0.3) { // 30% Ê¶ÇÁéáÂà∑Êñ∞
                refreshGameElements();
            }
        }, 30000); // ÊØè30Áßí

        // ÂàùÂßãÂåñ
        createWorksheet();
        updateDisplay();
        
        // Ëá™Âä®‰øùÂ≠òÊ∏∏ÊàèÁä∂ÊÄÅÔºà‰º™Ë£ÖÊàêExcelËá™Âä®‰øùÂ≠òÔºâ
        setInterval(() => {
            if (Math.random() < 0.1) {
                showMessage('Â∑•‰ΩúÁ∞øÂ∑≤Ëá™Âä®‰øùÂ≠ò');
            }
        }, 45000);
    </script>
</body>
</html>
