<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Excel - å·¥ä½œç°¿1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background-color: #f3f2f1;
            overflow: hidden;
        }

        /* Excelæ ‡é¢˜æ  */
        .excel-titlebar {
            background: #2b579a;
            color: white;
            padding: 8px 15px;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .excel-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .excel-logo {
            width: 20px;
            height: 20px;
            background: #107c41;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        .window-controls {
            display: flex;
            gap: 1px;
        }

        .control-btn {
            width: 45px;
            height: 29px;
            border: none;
            background: transparent;
            color: white;
            cursor: pointer;
            font-size: 12px;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        /* Excelèœå•æ  */
        .excel-menubar {
            background: #ffffff;
            border-bottom: 1px solid #d1d1d1;
            display: flex;
            align-items: center;
            height: 48px;
        }

        .menu-tabs {
            display: flex;
            margin-left: 15px;
        }

        .menu-tab {
            padding: 12px 20px;
            cursor: pointer;
            color: #323130;
            font-size: 14px;
            border-bottom: 3px solid transparent;
        }

        .menu-tab.active {
            border-bottom-color: #0078d4;
            color: #0078d4;
        }

        .menu-tab:hover {
            background: #f3f2f1;
        }

        /* Excelå·¥å…·æ  */
        .excel-toolbar {
            background: #ffffff;
            border-bottom: 1px solid #d1d1d1;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            height: 92px;
            flex-wrap: wrap;
        }

        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 5px;
            padding-right: 15px;
            border-right: 1px solid #d1d1d1;
        }

        .toolbar-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .toolbar-btn:hover {
            background: #f3f2f1;
        }

        /* å…¬å¼æ  */
        .formula-bar {
            background: #ffffff;
            border-bottom: 1px solid #d1d1d1;
            height: 25px;
            display: flex;
            align-items: center;
            padding: 0 15px;
        }

        .name-box {
            width: 80px;
            height: 21px;
            border: 1px solid #a6a6a6;
            padding: 0 5px;
            font-size: 11px;
        }

        .formula-input {
            flex: 1;
            height: 21px;
            border: 1px solid #a6a6a6;
            margin-left: 5px;
            padding: 0 5px;
            font-size: 11px;
        }

        /* Excelå·¥ä½œè¡¨åŒºåŸŸ */
        .excel-worksheet {
            background: #ffffff;
            height: calc(100vh - 225px);
            overflow: auto;
            position: relative;
        }

        /* è¡Œåˆ—æ ‡é¢˜ */
        .column-headers {
            position: sticky;
            top: 0;
            background: #f8f8f8;
            border-bottom: 1px solid #d4d4d4;
            display: flex;
            height: 20px;
            z-index: 10;
        }

        .corner-cell {
            width: 42px;
            min-width: 42px;
            background: #f8f8f8;
            border-right: 1px solid #d4d4d4;
            border-bottom: 1px solid #d4d4d4;
        }

        .column-header {
            width: 80px;
            min-width: 80px;
            text-align: center;
            font-size: 11px;
            color: #323130;
            line-height: 20px;
            border-right: 1px solid #d4d4d4;
            background: #f8f8f8;
            cursor: pointer;
        }

        /* å·¥ä½œè¡¨å†…å®¹ */
        .worksheet-content {
            display: flex;
            flex-direction: column;
        }

        .worksheet-row {
            display: flex;
            height: 20px;
        }

        .row-header {
            width: 42px;
            min-width: 42px;
            text-align: center;
            font-size: 11px;
            color: #323130;
            background: #f8f8f8;
            border-right: 1px solid #d4d4d4;
            border-bottom: 1px solid #e8e8e8;
            line-height: 20px;
            cursor: pointer;
        }

        .excel-cell {
            width: 80px;
            min-width: 80px;
            height: 20px;
            border-right: 1px solid #e8e8e8;
            border-bottom: 1px solid #e8e8e8;
            padding: 2px 6px;
            font-size: 11px;
            position: relative;
            cursor: cell;
        }

        .excel-cell:hover {
            background: #f3f2f1;
        }

        .excel-cell.selected {
            background: #0078d4;
            color: white;
        }

        .excel-cell.game-cell {
            background: #fff2cc;
            color: #9c5700;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }

        .excel-cell.monster-cell {
            background: #ffcccc;
            color: #c5504b;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }

        .excel-cell.treasure-cell {
            background: #e1dfdd;
            color: #7719aa;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
        }

        /* çŠ¶æ€æ  */
        .excel-statusbar {
            background: #0078d4;
            color: white;
            height: 22px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            font-size: 11px;
            justify-content: space-between;
        }

        .status-left {
            display: flex;
            gap: 20px;
        }

        .status-right {
            display: flex;
            gap: 10px;
        }

        /* æ¸¸æˆé¢æ¿ */
        .game-panel {
            position: fixed;
            top: 50px;
            right: 20px;
            width: 200px;
            background: white;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            padding: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            font-size: 12px;
            z-index: 1000;
            display: none;
        }

        .game-panel.show {
            display: block;
        }

        .panel-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #323130;
            border-bottom: 1px solid #e1dfdd;
            padding-bottom: 5px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e1dfdd;
            border-radius: 3px;
            overflow: hidden;
            margin: 5px 0;
        }

        .progress-fill {
            height: 100%;
            background: #0078d4;
            transition: width 0.3s;
        }

        /* éšè—çš„æ¸¸æˆæ¶ˆæ¯ */
        .game-message {
            position: fixed;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            background: #323130;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .game-message.show {
            opacity: 1;
        }

    </style>
</head>
<body>
    <!-- Excelæ ‡é¢˜æ  -->
    <div class="excel-titlebar">
        <div class="excel-title">
            <div class="excel-logo">X</div>
            <span>å·¥ä½œç°¿1 - Excel</span>
        </div>
        <div class="window-controls">
            <button class="control-btn">âˆ’</button>
            <button class="control-btn">â–¡</button>
            <button class="control-btn">Ã—</button>
        </div>
    </div>

    <!-- Excelèœå•æ  -->
    <div class="excel-menubar">
        <div class="menu-tabs">
            <div class="menu-tab">æ–‡ä»¶</div>
            <div class="menu-tab active">å¼€å§‹</div>
            <div class="menu-tab">æ’å…¥</div>
            <div class="menu-tab">é¡µé¢å¸ƒå±€</div>
            <div class="menu-tab">å…¬å¼</div>
            <div class="menu-tab">æ•°æ®</div>
            <div class="menu-tab">å®¡é˜…</div>
            <div class="menu-tab">è§†å›¾</div>
        </div>
    </div>

    <!-- Excelå·¥å…·æ  -->
    <div class="excel-toolbar">
        <div class="toolbar-group">
            <button class="toolbar-btn" title="ç²˜è´´">ğŸ“‹</button>
        </div>
        <div class="toolbar-group">
            <button class="toolbar-btn" title="å‰ªåˆ‡">âœ‚</button>
            <button class="toolbar-btn" title="å¤åˆ¶">ğŸ“„</button>
            <button class="toolbar-btn" title="æ ¼å¼åˆ·">ğŸ–Œ</button>
        </div>
        <div class="toolbar-group">
            <button class="toolbar-btn" title="åŠ ç²—">B</button>
            <button class="toolbar-btn" title="æ–œä½“">I</button>
            <button class="toolbar-btn" title="ä¸‹åˆ’çº¿">U</button>
        </div>
        <div class="toolbar-group">
            <button class="toolbar-btn" title="å‡½æ•°" onclick="toggleGamePanel()">fx</button>
            <button class="toolbar-btn" title="å›¾è¡¨" onclick="showGameStats()">ğŸ“Š</button>
        </div>
    </div>

    <!-- å…¬å¼æ  -->
    <div class="formula-bar">
        <input type="text" class="name-box" value="A1" readonly>
        <input type="text" class="formula-input" id="formulaInput" placeholder="ç‚¹å‡»å•å…ƒæ ¼å¼€å§‹æ¸¸æˆ..." readonly>
    </div>

    <!-- Excelå·¥ä½œè¡¨ -->
    <div class="excel-worksheet">
        <div class="column-headers">
            <div class="corner-cell"></div>
            <div class="column-header">A</div>
            <div class="column-header">B</div>
            <div class="column-header">C</div>
            <div class="column-header">D</div>
            <div class="column-header">E</div>
            <div class="column-header">F</div>
            <div class="column-header">G</div>
            <div class="column-header">H</div>
            <div class="column-header">I</div>
            <div class="column-header">J</div>
            <div class="column-header">K</div>
            <div class="column-header">L</div>
            <div class="column-header">M</div>
            <div class="column-header">N</div>
            <div class="column-header">O</div>
            <div class="column-header">P</div>
        </div>
        
        <div class="worksheet-content" id="worksheetContent">
            <!-- å·¥ä½œè¡¨è¡Œå°†é€šè¿‡JavaScriptç”Ÿæˆ -->
        </div>
    </div>

    <!-- ExcelçŠ¶æ€æ  -->
    <div class="excel-statusbar">
        <div class="status-left">
            <span>å°±ç»ª</span>
            <span id="gameStatus">ç»éªŒå€¼: 0 | ç­‰çº§: 1</span>
        </div>
        <div class="status-right">
            <span>100%</span>
            <span>ç¬¬ 1 é¡µï¼Œå…± 1 é¡µ</span>
        </div>
    </div>

    <!-- éšè—çš„æ¸¸æˆé¢æ¿ -->
    <div class="game-panel" id="gamePanel">
        <div class="panel-title">ğŸ“Š æ•°æ®é€è§†è¡¨</div>
        <div class="stat-row">
            <span>ç­‰çº§:</span>
            <span id="playerLevel">1</span>
        </div>
        <div class="stat-row">
            <span>ç»éªŒ:</span>
            <span id="playerExp">0/100</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="expBar" style="width: 0%"></div>
        </div>
        <div class="stat-row">
            <span>é‡‘å¸:</span>
            <span id="playerGold">0</span>
        </div>
        <div class="stat-row">
            <span>æ€ªç‰©å‡»è´¥:</span>
            <span id="monstersKilled">0</span>
        </div>
        <div class="stat-row">
            <span>å®ç®±å¼€å¯:</span>
            <span id="treasuresFound">0</span>
        </div>
    </div>


    <!-- æ¸¸æˆæ¶ˆæ¯ -->
    <div class="game-message" id="gameMessage"></div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            level: 1,
            exp: 0,
            expNeeded: 100,
            gold: 0,
            monstersKilled: 0,
            treasuresFound: 0,
            totalClicks: 0,
            errorCount: 0
        };

        // æ¸¸æˆæ•°æ®
        const gameData = {
            monsters: ['ğŸ‘¹', 'ğŸ‰', 'ğŸ‘¾', 'ğŸ¦–', 'ğŸ•·ï¸', 'ğŸº', 'ğŸ¦‡', 'ğŸ'],
            treasures: ['ğŸ’', 'ğŸ‘‘', 'ğŸ’°', 'ğŸ†', 'ğŸ’', 'ğŸ', 'âš±ï¸', 'ğŸ“¿'],
            heroes: ['ğŸ§™', 'âš”ï¸', 'ğŸ›¡ï¸', 'ğŸ¹', 'âš¡', 'ğŸ”¥', 'â„ï¸', 'âœ¨']
        };

        // åˆ›å»ºå·¥ä½œè¡¨
        function createWorksheet() {
            const worksheetContent = document.getElementById('worksheetContent');
            worksheetContent.innerHTML = '';

            for (let row = 1; row <= 50; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'worksheet-row';
                
                // è¡Œæ ‡é¢˜
                const rowHeader = document.createElement('div');
                rowHeader.className = 'row-header';
                rowHeader.textContent = row;
                rowDiv.appendChild(rowHeader);

                // å•å…ƒæ ¼
                for (let col = 0; col < 16; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'excel-cell';
                    cell.setAttribute('data-row', row);
                    cell.setAttribute('data-col', col);
                    
                    // éšæœºæ·»åŠ æ¸¸æˆå…ƒç´ 
                    if (Math.random() < 0.02) { // 2% æ¦‚ç‡
                        const type = Math.random();
                        if (type < 0.4) {
                            // æ€ªç‰©
                            cell.className += ' monster-cell';
                            cell.textContent = gameData.monsters[Math.floor(Math.random() * gameData.monsters.length)];
                            cell.setAttribute('data-type', 'monster');
                        } else if (type < 0.7) {
                            // å®ç®±
                            cell.className += ' treasure-cell';
                            cell.textContent = gameData.treasures[Math.floor(Math.random() * gameData.treasures.length)];
                            cell.setAttribute('data-type', 'treasure');
                        } else {
                            // è‹±é›„/æŠ€èƒ½
                            cell.className += ' game-cell';
                            cell.textContent = gameData.heroes[Math.floor(Math.random() * gameData.heroes.length)];
                            cell.setAttribute('data-type', 'hero');
                        }
                    } else {
                        // æ™®é€šæ•°æ®
                        const dataTypes = [
                            Math.floor(Math.random() * 1000),
                            (Math.random() * 100).toFixed(2),
                            '',
                            ['A', 'B', 'C', 'D'][Math.floor(Math.random() * 4)],
                            Math.floor(Math.random() * 10000),
                            ''
                        ];
                        cell.textContent = dataTypes[Math.floor(Math.random() * dataTypes.length)];
                    }
                    
                    cell.addEventListener('click', handleCellClick);
                    rowDiv.appendChild(cell);
                }
                
                worksheetContent.appendChild(rowDiv);
            }
        }

        // å¤„ç†å•å…ƒæ ¼ç‚¹å‡»
        function handleCellClick(event) {
            const cell = event.target;
            const type = cell.getAttribute('data-type');
            const row = cell.getAttribute('data-row');
            const col = String.fromCharCode(65 + parseInt(cell.getAttribute('data-col')));
            
            // æ›´æ–°å…¬å¼æ 
            document.getElementById('formulaInput').value = `=${col}${row}`;
            document.querySelector('.name-box').value = `${col}${row}`;

            gameState.totalClicks++;
            
            if (type === 'monster') {
                // å‡»è´¥æ€ªç‰©
                const exp = Math.floor(Math.random() * 25) + 10;
                const gold = Math.floor(Math.random() * 15) + 5;
                
                addExp(exp);
                gameState.gold += gold;
                gameState.monstersKilled++;
                
                cell.textContent = 'ğŸ’€';
                cell.className = 'excel-cell';
                cell.removeAttribute('data-type');
                
                showMessage(`å‡»è´¥æ€ªç‰©! +${exp} ç»éªŒ, +${gold} é‡‘å¸`);
                
            } else if (type === 'treasure') {
                // å¼€å¯å®ç®±
                const exp = Math.floor(Math.random() * 40) + 20;
                const gold = Math.floor(Math.random() * 30) + 15;
                
                addExp(exp);
                gameState.gold += gold;
                gameState.treasuresFound++;
                
                cell.textContent = 'ğŸ“¦';
                cell.className = 'excel-cell';
                cell.removeAttribute('data-type');
                
                showMessage(`å‘ç°å®ç®±! +${exp} ç»éªŒ, +${gold} é‡‘å¸`);
                
            } else if (type === 'hero') {
                // è·å¾—æŠ€èƒ½/buff
                const exp = Math.floor(Math.random() * 15) + 5;
                addExp(exp);
                
                cell.textContent = 'â­';
                cell.className = 'excel-cell';
                cell.removeAttribute('data-type');
                
                showMessage(`è·å¾—æŠ€èƒ½å¼ºåŒ–! +${exp} ç»éªŒ`);
                
            } else {
                // æ™®é€šå•å…ƒæ ¼ - å°é‡ç»éªŒ
                if (Math.random() < 0.1) { // 10% æ¦‚ç‡è·å¾—ç»éªŒ
                    const exp = Math.floor(Math.random() * 3) + 1;
                    addExp(exp);
                    showMessage(`æ•°æ®åˆ†æå®Œæˆ +${exp} ç»éªŒ`);
                }
            }
            
            updateDisplay();
        }

        // å¢åŠ ç»éªŒå€¼
        function addExp(amount) {
            gameState.exp += amount;
            
            // æ£€æŸ¥å‡çº§
            while (gameState.exp >= gameState.expNeeded) {
                gameState.exp -= gameState.expNeeded;
                gameState.level++;
                gameState.expNeeded = Math.floor(gameState.expNeeded * 1.5);
                
                showMessage(`ğŸ‰ ç­‰çº§æå‡! ç°åœ¨æ˜¯ ${gameState.level} çº§!`);
                
                // å‡çº§æ—¶åˆ·æ–°åœ°å›¾
                setTimeout(() => {
                    refreshGameElements();
                }, 1000);
            }
        }

        // åˆ·æ–°æ¸¸æˆå…ƒç´ 
        function refreshGameElements() {
            const cells = document.querySelectorAll('.excel-cell');
            let addedElements = 0;
            
            cells.forEach(cell => {
                if (!cell.getAttribute('data-type') && addedElements < 15) {
                    if (Math.random() < 0.05) { // 5% æ¦‚ç‡æ·»åŠ æ–°å…ƒç´ 
                        const type = Math.random();
                        if (type < 0.4) {
                            cell.className = 'excel-cell monster-cell';
                            cell.textContent = gameData.monsters[Math.floor(Math.random() * gameData.monsters.length)];
                            cell.setAttribute('data-type', 'monster');
                        } else if (type < 0.7) {
                            cell.className = 'excel-cell treasure-cell';
                            cell.textContent = gameData.treasures[Math.floor(Math.random() * gameData.treasures.length)];
                            cell.setAttribute('data-type', 'treasure');
                        } else {
                            cell.className = 'excel-cell game-cell';
                            cell.textContent = gameData.heroes[Math.floor(Math.random() * gameData.heroes.length)];
                            cell.setAttribute('data-type', 'hero');
                        }
                        addedElements++;
                    }
                }
            });
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message) {
            const messageEl = document.getElementById('gameMessage');
            messageEl.textContent = message;
            messageEl.classList.add('show');
            
            setTimeout(() => {
                messageEl.classList.remove('show');
            }, 2000);
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            // æ›´æ–°çŠ¶æ€æ 
            document.getElementById('gameStatus').textContent = 
                `ç»éªŒå€¼: ${gameState.exp}/${gameState.expNeeded} | ç­‰çº§: ${gameState.level}`;
            
            // æ›´æ–°æ¸¸æˆé¢æ¿
            document.getElementById('playerLevel').textContent = gameState.level;
            document.getElementById('playerExp').textContent = `${gameState.exp}/${gameState.expNeeded}`;
            document.getElementById('playerGold').textContent = gameState.gold;
            document.getElementById('monstersKilled').textContent = gameState.monstersKilled;
            document.getElementById('treasuresFound').textContent = gameState.treasuresFound;
            
            const expPercent = (gameState.exp / gameState.expNeeded) * 100;
            document.getElementById('expBar').style.width = `${expPercent}%`;
            
        }

        // åˆ‡æ¢æ¸¸æˆé¢æ¿
        function toggleGamePanel() {
            const panel = document.getElementById('gamePanel');
            panel.classList.toggle('show');
        }

        // æ˜¾ç¤ºæ¸¸æˆç»Ÿè®¡
        function showGameStats() {
            const panel = document.getElementById('gamePanel');
            panel.classList.add('show');
            showMessage('æ•°æ®é€è§†è¡¨å·²æ›´æ–°');
        }

        // è‡ªåŠ¨åˆ·æ–°æ¸¸æˆå…ƒç´ 
        setInterval(() => {
            if (Math.random() < 0.3) { // 30% æ¦‚ç‡åˆ·æ–°
                refreshGameElements();
            }
        }, 30000); // æ¯30ç§’

        // åˆå§‹åŒ–
        createWorksheet();
        updateDisplay();
        
        // è‡ªåŠ¨ä¿å­˜æ¸¸æˆçŠ¶æ€ï¼ˆä¼ªè£…æˆExcelè‡ªåŠ¨ä¿å­˜ï¼‰
        setInterval(() => {
            if (Math.random() < 0.1) {
                showMessage('å·¥ä½œç°¿å·²è‡ªåŠ¨ä¿å­˜');
            }
        }, 45000);
    </script>
</body>
</html>
